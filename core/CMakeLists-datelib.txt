# Builds external third party projects.
# The parent script needs to define the "GLOBAL_OUTPUT_PATH" variable,
# which will be used as output directory for all *.lib, *.dll, *.a, *.so, *.pdb files.

ExternalProject_Add(
  DateLib

  GIT_REPOSITORY "https://github.com/HowardHinnant/date"
  GIT_TAG "v1"

  UPDATE_COMMAND ""
  PATCH_COMMAND patch ${CMAKE_CURRENT_SOURCE_DIR}/lib/date/date.h < ${CMAKE_CURRENT_SOURCE_DIR}/lib/check_definition.patch
  TEST_COMMAND ""
  CONFIGURE_COMMAND ""
  BUILD_COMMAND ""
  INSTALL_COMMAND ""

  SOURCE_DIR "${CMAKE_CURRENT_SOURCE_DIR}/lib/date"
)

# ExternalProject_Add_Step(
#   HumbleLogging CopyToBin
#   COMMAND ${CMAKE_COMMAND} -E copy_directory ${GLOBAL_OUTPUT_PATH}/humblelogging/bin ${GLOBAL_OUTPUT_PATH}
#   COMMAND ${CMAKE_COMMAND} -E copy_directory ${GLOBAL_OUTPUT_PATH}/humblelogging/lib ${GLOBAL_OUTPUT_PATH}
#   DEPENDEES install
# )

ExternalProject_Get_Property(DateLib source_dir)
set(Datelib_INCLUDE_DIRS "${source_dir}")
# set(HumbleLogging_LIBRARIES "${CMAKE_SHARED_LIBRARY_PREFIX}humblelogging${CMAKE_SHARED_LIBRARY_SUFFIX}")
# include_directories(${Datelib_INCLUDE_DIRS})
